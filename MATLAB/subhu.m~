function sub = subhu(img, ctr, varargin)
%EXTHU Calculate Hu moments for a subset of an image
%   Detailed explanation goes here

% Loop over varargin elements
while ~isempty(varargin)
    switch lower(varargin{1})

        case 'mask'
            mask = varargin{2};
        case 'radius'
            radius = varargin{2};

    end

    varargin(1:2) = [];
end

if ~exist('radius', 'var')
    radius = 20;
end
r = radius;
if ~exist('mask', 'var')
    [X,Y] = ndgrid(-r:r, -r:r);
    mask = uint16(sqrt(X.^2+Y.^2)<=r);
end

% [X,Y] = ndgrid(-r:r, -r:r);
sub = img(ctr(1)+(-r:r), ctr(2)+(-r:r));
% sub = sub >= mean(sub);
sub = sub.*mask;

n00 = im_moment(sub,0,0);
n = @(i,j) im_moment(sub,i,j) / n00^(1+(i+j)/2);

n20 = n(2,0);
n02 = n(0,2);
n12 = n(1,2);
n21 = n(2,1);
n30 = n(3,0);
n03 = n(0,3);

I = zeros(4);
I[1] = n20 +

end

